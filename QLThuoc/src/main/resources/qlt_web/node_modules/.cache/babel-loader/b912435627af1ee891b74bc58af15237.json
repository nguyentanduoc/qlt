{"ast":null,"code":"import _regeneratorRuntime from \"D:\\\\LV\\\\qlt\\\\qlt_web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\LV\\\\qlt\\\\qlt_web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport { ACTION_TYPES, API, LOCAL_STORAGE } from '../constants';\nimport { showAlertFail, showAlertAndReset } from './alertAction.js';\nimport headerConfig from '../helpers/headerHelper';\nimport axios from 'axios';\nexport var login = function login(auth) {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(dispatch) {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return axios.post(API.LOGIN, auth);\n\n              case 3:\n                res = _context.sent;\n                dispatch(loginSuccess(res.data));\n                _context.next = 10;\n                break;\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](0);\n\n                if (_context.t0 && _context.t0.response && _context.t0.response.data && _context.t0.response.data.message) {\n                  dispatch(loginFail(_context.t0.response.data.message));\n                } else {\n                  dispatch(loginFail(_context.t0.toString()));\n                }\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 7]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var loginSuccess = function loginSuccess(data) {\n  sessionStorage.setItem(LOCAL_STORAGE.IS_LOGIN, true);\n  sessionStorage.setItem(LOCAL_STORAGE.ACCESS_KEY, data.jwtAuthenticationResponse.accessToken);\n  return {\n    type: ACTION_TYPES.AUTH.LOGIN_SUCCESS,\n    payload: data\n  };\n};\nexport var loginFail = function loginFail(err) {\n  return {\n    type: ACTION_TYPES.HAS_ERROR,\n    payload: err\n  };\n};\nexport var logout = function logout() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(dispatch) {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return axios.post(API.LOGOUT, null, headerConfig);\n\n              case 3:\n                res = _context2.sent;\n\n                if (!(res.status === 200)) {\n                  _context2.next = 9;\n                  break;\n                }\n\n                _context2.next = 7;\n                return sessionStorage.removeItem(LOCAL_STORAGE.IS_LOGIN);\n\n              case 7:\n                _context2.next = 9;\n                return sessionStorage.removeItem(LOCAL_STORAGE.ACCESS_KEY);\n\n              case 9:\n                return _context2.abrupt(\"return\", dispatch(logoutSuccess()));\n\n              case 12:\n                _context2.prev = 12;\n                _context2.t0 = _context2[\"catch\"](0);\n                return _context2.abrupt(\"return\", dispatch(showAlertFail(\"Thoát thất bại\")));\n\n              case 15:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 12]]);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var logoutSuccess = function logoutSuccess() {\n  return {\n    type: ACTION_TYPES.AUTH.LOGOUT\n  };\n};\nexport var setBranch = function setBranch(branch) {\n  return {\n    type: ACTION_TYPES.AUTH.SET_BRANCH,\n    payload: branch\n  };\n};","map":{"version":3,"sources":["D:\\LV\\qlt\\qlt_web\\src\\actions\\authenAction.js"],"names":["ACTION_TYPES","API","LOCAL_STORAGE","showAlertFail","showAlertAndReset","headerConfig","axios","login","auth","dispatch","post","LOGIN","res","loginSuccess","data","response","message","loginFail","toString","sessionStorage","setItem","IS_LOGIN","ACCESS_KEY","jwtAuthenticationResponse","accessToken","type","AUTH","LOGIN_SUCCESS","payload","err","HAS_ERROR","logout","LOGOUT","status","removeItem","logoutSuccess","setBranch","branch","SET_BRANCH"],"mappings":"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","sourcesContent":["import { ACTION_TYPES, API, LOCAL_STORAGE } from '../constants';\r\nimport {showAlertFail, showAlertAndReset} from './alertAction.js'\r\nimport headerConfig from '../helpers/headerHelper'\r\nimport axios from 'axios';\r\n\r\nexport const login = (auth) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      const res = await axios.post(API.LOGIN, auth);\r\n      dispatch(loginSuccess(res.data));\r\n    }\r\n    catch (err) {\r\n      if (err && err.response && err.response.data && err.response.data.message) {\r\n        dispatch(loginFail(err.response.data.message));\r\n      } else {\r\n        dispatch(loginFail(err.toString()));\r\n      }\r\n    } \r\n  }\r\n}\r\nexport const loginSuccess = (data) => {\r\n  sessionStorage.setItem(LOCAL_STORAGE.IS_LOGIN, true);\r\n  sessionStorage.setItem(LOCAL_STORAGE.ACCESS_KEY, data.jwtAuthenticationResponse.accessToken);\r\n  return {\r\n    type: ACTION_TYPES.AUTH.LOGIN_SUCCESS,\r\n    payload: data\r\n  }\r\n}\r\n\r\nexport const loginFail = (err) => {\r\n  return {\r\n    type: ACTION_TYPES.HAS_ERROR,\r\n    payload: err\r\n  }\r\n}\r\n\r\nexport const logout = () => {\r\n  return async (dispatch) => {\r\n    try{\r\n      const res = await axios.post(API.LOGOUT, null, headerConfig);\r\n      if(res.status === 200){\r\n        await sessionStorage.removeItem(LOCAL_STORAGE.IS_LOGIN);\r\n        await sessionStorage.removeItem(LOCAL_STORAGE.ACCESS_KEY);\r\n      }\r\n      return dispatch(logoutSuccess());\r\n    } catch (err) {\r\n      return dispatch(showAlertFail(\"Thoát thất bại\"));\r\n    }\r\n  }\r\n  \r\n}\r\nexport const logoutSuccess = () => {\r\n  return {\r\n    type: ACTION_TYPES.AUTH.LOGOUT\r\n  }\r\n}\r\nexport const setBranch = (branch) => {\r\n  return {\r\n    type: ACTION_TYPES.AUTH.SET_BRANCH,\r\n    payload: branch\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}