{"ast":null,"code":"import _regeneratorRuntime from \"D:\\\\LV\\\\qlt\\\\QLThuoc\\\\src\\\\main\\\\resources\\\\qlt_web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\LV\\\\qlt\\\\QLThuoc\\\\src\\\\main\\\\resources\\\\qlt_web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport { ACTION_TYPES, API, LOCAL_STORAGE } from '../constants';\nimport { showAlertFail } from './alertAction.js';\nimport axios from 'axios';\nexport var login = function login(auth) {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(dispatch) {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return axios.post(API.LOGIN, auth);\n\n              case 3:\n                res = _context.sent;\n                dispatch(loginSuccess(res.data));\n                _context.next = 11;\n                break;\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](0);\n                dispatch(setLoading());\n\n                if (_context.t0 && _context.t0.response && _context.t0.response.data && _context.t0.response.data.message) {\n                  dispatch(loginFail(_context.t0.response.data.message));\n                } else {\n                  dispatch(loginFail(_context.t0.toString()));\n                }\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 7]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var loginSuccess = function loginSuccess(data) {\n  sessionStorage.setItem(LOCAL_STORAGE.IS_LOGIN, true);\n  sessionStorage.setItem(LOCAL_STORAGE.ACCESS_KEY, data.jwtAuthenticationResponse.accessToken);\n  return {\n    type: ACTION_TYPES.AUTH.LOGIN_SUCCESS,\n    payload: data\n  };\n};\nexport var loginFail = function loginFail(err) {\n  return {\n    type: ACTION_TYPES.HAS_ERROR,\n    payload: err\n  };\n};\nexport var logout = function logout() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(dispatch) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return sessionStorage.removeItem(LOCAL_STORAGE.IS_LOGIN);\n\n              case 3:\n                _context2.next = 5;\n                return sessionStorage.removeItem(LOCAL_STORAGE.ACCESS_KEY);\n\n              case 5:\n                return _context2.abrupt(\"return\", dispatch(logoutSuccess()));\n\n              case 8:\n                _context2.prev = 8;\n                _context2.t0 = _context2[\"catch\"](0);\n                return _context2.abrupt(\"return\", dispatch(showAlertFail(\"Thoát thất bại\")));\n\n              case 11:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 8]]);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var logoutSuccess = function logoutSuccess() {\n  return {\n    type: ACTION_TYPES.AUTH.LOGOUT\n  };\n};\nexport var setBranch = function setBranch(branch) {\n  return {\n    type: ACTION_TYPES.AUTH.SET_BRANCH,\n    payload: branch\n  };\n};\nexport var setLoading = function setLoading() {\n  return {\n    type: ACTION_TYPES.AUTH.SET_LOADING\n  };\n};","map":{"version":3,"sources":["D:\\LV\\qlt\\QLThuoc\\src\\main\\resources\\qlt_web\\src\\actions\\authenAction.js"],"names":["ACTION_TYPES","API","LOCAL_STORAGE","showAlertFail","axios","login","auth","dispatch","post","LOGIN","res","loginSuccess","data","setLoading","response","message","loginFail","toString","sessionStorage","setItem","IS_LOGIN","ACCESS_KEY","jwtAuthenticationResponse","accessToken","type","AUTH","LOGIN_SUCCESS","payload","err","HAS_ERROR","logout","removeItem","logoutSuccess","LOGOUT","setBranch","branch","SET_BRANCH","SET_LOADING"],"mappings":";;AAAA,SAASA,YAAT,EAAuBC,GAAvB,EAA4BC,aAA5B,QAAiD,cAAjD;AACA,SAAQC,aAAR,QAA4B,kBAA5B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAO,IAAMC,KAAK,GAAG,SAARA,KAAQ,CAACC,IAAD,EAAU;AAC7B;AAAA;AAAA;AAAA;AAAA;AAAA,+BAAO,iBAAOC,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEeH,KAAK,CAACI,IAAN,CAAWP,GAAG,CAACQ,KAAf,EAAsBH,IAAtB,CAFf;;AAAA;AAEGI,gBAAAA,GAFH;AAGHH,gBAAAA,QAAQ,CAACI,YAAY,CAACD,GAAG,CAACE,IAAL,CAAb,CAAR;AAHG;AAAA;;AAAA;AAAA;AAAA;AAMHL,gBAAAA,QAAQ,CAACM,UAAU,EAAX,CAAR;;AACA,oBAAI,eAAO,YAAIC,QAAX,IAAuB,YAAIA,QAAJ,CAAaF,IAApC,IAA4C,YAAIE,QAAJ,CAAaF,IAAb,CAAkBG,OAAlE,EAA2E;AACzER,kBAAAA,QAAQ,CAACS,SAAS,CAAC,YAAIF,QAAJ,CAAaF,IAAb,CAAkBG,OAAnB,CAAV,CAAR;AACD,iBAFD,MAEO;AACLR,kBAAAA,QAAQ,CAACS,SAAS,CAAC,YAAIC,QAAJ,EAAD,CAAV,CAAR;AACD;;AAXE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAcD,CAfM;AAgBP,OAAO,IAAMN,YAAY,GAAG,SAAfA,YAAe,CAACC,IAAD,EAAU;AACpCM,EAAAA,cAAc,CAACC,OAAf,CAAuBjB,aAAa,CAACkB,QAArC,EAA+C,IAA/C;AACAF,EAAAA,cAAc,CAACC,OAAf,CAAuBjB,aAAa,CAACmB,UAArC,EAAiDT,IAAI,CAACU,yBAAL,CAA+BC,WAAhF;AACA,SAAO;AACLC,IAAAA,IAAI,EAAExB,YAAY,CAACyB,IAAb,CAAkBC,aADnB;AAELC,IAAAA,OAAO,EAAEf;AAFJ,GAAP;AAID,CAPM;AASP,OAAO,IAAMI,SAAS,GAAG,SAAZA,SAAY,CAACY,GAAD,EAAS;AAChC,SAAO;AACLJ,IAAAA,IAAI,EAAExB,YAAY,CAAC6B,SADd;AAELF,IAAAA,OAAO,EAAEC;AAFJ,GAAP;AAID,CALM;AAOP,OAAO,IAAME,MAAM,GAAG,SAATA,MAAS,GAAM;AAC1B;AAAA;AAAA;AAAA;AAAA;AAAA,+BAAO,kBAAOvB,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAGGW,cAAc,CAACa,UAAf,CAA0B7B,aAAa,CAACkB,QAAxC,CAHH;;AAAA;AAAA;AAAA,uBAIGF,cAAc,CAACa,UAAf,CAA0B7B,aAAa,CAACmB,UAAxC,CAJH;;AAAA;AAAA,kDAKId,QAAQ,CAACyB,aAAa,EAAd,CALZ;;AAAA;AAAA;AAAA;AAAA,kDAOIzB,QAAQ,CAACJ,aAAa,CAAC,gBAAD,CAAd,CAPZ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAP;;AAAA;AAAA;AAAA;AAAA;AAAA;AAWD,CAZM;AAaP,OAAO,IAAM6B,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AACjC,SAAO;AACLR,IAAAA,IAAI,EAAExB,YAAY,CAACyB,IAAb,CAAkBQ;AADnB,GAAP;AAGD,CAJM;AAKP,OAAO,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,MAAD,EAAY;AACnC,SAAO;AACLX,IAAAA,IAAI,EAAExB,YAAY,CAACyB,IAAb,CAAkBW,UADnB;AAELT,IAAAA,OAAO,EAAEQ;AAFJ,GAAP;AAID,CALM;AAMP,OAAO,IAAMtB,UAAU,GAAG,SAAbA,UAAa,GAAM;AAC9B,SAAO;AACLW,IAAAA,IAAI,EAACxB,YAAY,CAACyB,IAAb,CAAkBY;AADlB,GAAP;AAGD,CAJM","sourcesContent":["import { ACTION_TYPES, API, LOCAL_STORAGE } from '../constants';\nimport {showAlertFail} from './alertAction.js'\nimport axios from 'axios';\n\nexport const login = (auth) => {\n  return async (dispatch) => {\n    try {\n      const res = await axios.post(API.LOGIN, auth);\n      dispatch(loginSuccess(res.data));\n    }\n    catch (err) {\n      dispatch(setLoading());\n      if (err && err.response && err.response.data && err.response.data.message) {\n        dispatch(loginFail(err.response.data.message));\n      } else {\n        dispatch(loginFail(err.toString()));\n      }\n    } \n  }\n}\nexport const loginSuccess = (data) => {\n  sessionStorage.setItem(LOCAL_STORAGE.IS_LOGIN, true);\n  sessionStorage.setItem(LOCAL_STORAGE.ACCESS_KEY, data.jwtAuthenticationResponse.accessToken);\n  return {\n    type: ACTION_TYPES.AUTH.LOGIN_SUCCESS,\n    payload: data\n  }\n}\n\nexport const loginFail = (err) => {\n  return {\n    type: ACTION_TYPES.HAS_ERROR,\n    payload: err\n  }\n}\n\nexport const logout = () => {\n  return async (dispatch) => {\n    try{\n      // const res = await axios.post(API.LOGOUT, null, headerConfig);\n      await sessionStorage.removeItem(LOCAL_STORAGE.IS_LOGIN);\n      await sessionStorage.removeItem(LOCAL_STORAGE.ACCESS_KEY);\n      return dispatch(logoutSuccess());\n    } catch (err) {\n      return dispatch(showAlertFail(\"Thoát thất bại\"));\n    }\n  }\n  \n}\nexport const logoutSuccess = () => {\n  return {\n    type: ACTION_TYPES.AUTH.LOGOUT\n  }\n}\nexport const setBranch = (branch) => {\n  return {\n    type: ACTION_TYPES.AUTH.SET_BRANCH,\n    payload: branch\n  }\n}\nexport const setLoading = () => {\n  return {\n    type:ACTION_TYPES.AUTH.SET_LOADING\n  }\n}\n"]},"metadata":{},"sourceType":"module"}