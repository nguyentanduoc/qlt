{"ast":null,"code":"import _objectSpread from \"D:\\\\LV\\\\qlt\\\\qlt_web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport { ACTION_TYPES } from '../constants';\nimport _ from 'lodash';\nvar initState = {\n  errors: \"\",\n  authentication: {},\n  isLogin: false,\n  nav: [],\n  user: {},\n  authorities: [],\n  isChooseBranch: false,\n  branch: {},\n  branches: []\n};\nexport default (function () {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initState;\n  var action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case ACTION_TYPES.AUTH.LOGIN_SUCCESS:\n      var payload = action.payload;\n\n      if (payload.branchs && payload.branchs.length > 1) {\n        return _objectSpread({}, state, {\n          authentication: payload.authentication,\n          isLogin: true,\n          nav: payload.nav,\n          user: payload.user,\n          authorities: payload.authorities,\n          isChooseBranch: true,\n          branches: payload.branches\n        });\n      } else {\n        var navs = navBranch(payload.nav, payload.branches[0]);\n        return _objectSpread({}, state, {\n          authentication: payload.authentication,\n          isLogin: true,\n          nav: payload.nav,\n          user: payload.user,\n          authorities: payload.authorities,\n          isChooseBranch: false,\n          branch: payload.branches[0]\n        });\n      }\n\n    case ACTION_TYPES.AUTH.SET_BRANCH:\n      // const nav = navBranch(payload.nav, action.payload);\n      return _objectSpread({}, state, {\n        branch: action.payload,\n        nav: nav\n      });\n\n    case ACTION_TYPES.AUTH.LOGOUT:\n      return initState;\n\n    default:\n      return state;\n  }\n});\n\nvar navBranch = function navBranch(navs, branch) {\n  navs.forEach(function (element) {\n    _.remove(element.children, function (nav) {\n      if (nav.isMain) {\n        console.log(nav);\n\n        if (branch.isMain == nav.isMain) {\n          return nav;\n        } else {// console.log(nav);\n        }\n      }\n    });\n  });\n};","map":{"version":3,"sources":["D:\\LV\\qlt\\qlt_web\\src\\reducers\\authReducer.js"],"names":["ACTION_TYPES","_","initState","errors","authentication","isLogin","nav","user","authorities","isChooseBranch","branch","branches","state","action","type","AUTH","LOGIN_SUCCESS","payload","branchs","length","navs","navBranch","SET_BRANCH","LOGOUT","forEach","element","remove","children","isMain","console","log"],"mappings":";AAAA,SAAQA,YAAR,QAA2B,cAA3B;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,IAAMC,SAAS,GAAI;AACjBC,EAAAA,MAAM,EAAC,EADU;AAEjBC,EAAAA,cAAc,EAAC,EAFE;AAGjBC,EAAAA,OAAO,EAAE,KAHQ;AAIjBC,EAAAA,GAAG,EAAC,EAJa;AAKjBC,EAAAA,IAAI,EAAE,EALW;AAMjBC,EAAAA,WAAW,EAAE,EANI;AAOjBC,EAAAA,cAAc,EAAE,KAPC;AAQjBC,EAAAA,MAAM,EAAC,EARU;AASjBC,EAAAA,QAAQ,EAAC;AATQ,CAAnB;AAWA,gBAAe,YAA+B;AAAA,MAA9BC,KAA8B,uEAAtBV,SAAsB;AAAA,MAAXW,MAAW;;AAC5C,UAAQA,MAAM,CAACC,IAAf;AACE,SAAKd,YAAY,CAACe,IAAb,CAAkBC,aAAvB;AACE,UAAMC,OAAO,GAAGJ,MAAM,CAACI,OAAvB;;AACA,UAAGA,OAAO,CAACC,OAAR,IAAmBD,OAAO,CAACC,OAAR,CAAgBC,MAAhB,GAAyB,CAA/C,EAAkD;AAC9C,iCAAWP,KAAX;AACER,UAAAA,cAAc,EAAEa,OAAO,CAACb,cAD1B;AAEEC,UAAAA,OAAO,EAAE,IAFX;AAGEC,UAAAA,GAAG,EAAEW,OAAO,CAACX,GAHf;AAIEC,UAAAA,IAAI,EAAEU,OAAO,CAACV,IAJhB;AAKEC,UAAAA,WAAW,EAAES,OAAO,CAACT,WALvB;AAMEC,UAAAA,cAAc,EAAE,IANlB;AAOEE,UAAAA,QAAQ,EAAEM,OAAO,CAACN;AAPpB;AASD,OAVH,MAUS;AACL,YAAMS,IAAI,GAAGC,SAAS,CAACJ,OAAO,CAACX,GAAT,EAAcW,OAAO,CAACN,QAAR,CAAiB,CAAjB,CAAd,CAAtB;AACA,iCAAWC,KAAX;AACER,UAAAA,cAAc,EAAEa,OAAO,CAACb,cAD1B;AAEEC,UAAAA,OAAO,EAAE,IAFX;AAGEC,UAAAA,GAAG,EAAEW,OAAO,CAACX,GAHf;AAIEC,UAAAA,IAAI,EAAEU,OAAO,CAACV,IAJhB;AAKEC,UAAAA,WAAW,EAAES,OAAO,CAACT,WALvB;AAMEC,UAAAA,cAAc,EAAE,KANlB;AAOEC,UAAAA,MAAM,EAAEO,OAAO,CAACN,QAAR,CAAiB,CAAjB;AAPV;AASD;;AAEL,SAAKX,YAAY,CAACe,IAAb,CAAkBO,UAAvB;AACE;AACA,+BAAWV,KAAX;AAAkBF,QAAAA,MAAM,EAAEG,MAAM,CAACI,OAAjC;AAA0CX,QAAAA,GAAG,EAAEA;AAA/C;;AAEF,SAAKN,YAAY,CAACe,IAAb,CAAkBQ,MAAvB;AACE,aAAOrB,SAAP;;AAEF;AACE,aAAOU,KAAP;AAlCJ;AAoCD,CArCD;;AAsCA,IAAMS,SAAS,GAAG,SAAZA,SAAY,CAACD,IAAD,EAAOV,MAAP,EAAkB;AAElCU,EAAAA,IAAI,CAACI,OAAL,CAAa,UAAAC,OAAO,EAAI;AACtBxB,IAAAA,CAAC,CAACyB,MAAF,CAASD,OAAO,CAACE,QAAjB,EAA2B,UAASrB,GAAT,EAAc;AACvC,UAAGA,GAAG,CAACsB,MAAP,EAAe;AACbC,QAAAA,OAAO,CAACC,GAAR,CAAYxB,GAAZ;;AACA,YAAGI,MAAM,CAACkB,MAAP,IAAiBtB,GAAG,CAACsB,MAAxB,EAA+B;AAC7B,iBAAOtB,GAAP;AACD,SAFD,MAEO,CACL;AACD;AACF;AACF,KATD;AAUD,GAXD;AAYD,CAdD","sourcesContent":["import {ACTION_TYPES} from '../constants';\nimport _ from 'lodash';\nconst initState  = {\n  errors:\"\",\n  authentication:{},\n  isLogin: false,\n  nav:[],\n  user: {},\n  authorities: [],\n  isChooseBranch: false,\n  branch:{},\n  branches:[]\n};\nexport default (state = initState, action) => {\n  switch (action.type) {\n    case ACTION_TYPES.AUTH.LOGIN_SUCCESS:\n      const payload = action.payload;\n      if(payload.branchs && payload.branchs.length > 1) {\n          return {...state, \n            authentication: payload.authentication, \n            isLogin: true, \n            nav: payload.nav, \n            user: payload.user,\n            authorities: payload.authorities,\n            isChooseBranch: true,\n            branches: payload.branches\n          };\n        } else {\n          const navs = navBranch(payload.nav, payload.branches[0]);\n          return {...state, \n            authentication: payload.authentication,\n            isLogin: true, \n            nav: payload.nav,\n            user: payload.user,\n            authorities: payload.authorities,\n            isChooseBranch: false,\n            branch: payload.branches[0]\n          };\n        }\n\n    case ACTION_TYPES.AUTH.SET_BRANCH:\n      // const nav = navBranch(payload.nav, action.payload);\n      return {...state, branch: action.payload, nav: nav}\n    \n    case ACTION_TYPES.AUTH.LOGOUT:\n      return initState;\n    \n    default:\n      return state;\n  }\n}\nconst navBranch = (navs, branch) => {\n\n  navs.forEach(element => {\n    _.remove(element.children, function(nav) {\n      if(nav.isMain) {\n        console.log(nav);\n        if(branch.isMain == nav.isMain){\n          return nav;\n        } else {\n          // console.log(nav);\n        }\n      }\n    });\n  });\n}\n"]},"metadata":{},"sourceType":"module"}