{"ast":null,"code":"import _regeneratorRuntime from \"D:\\\\LV\\\\qlt\\\\QLThuoc\\\\src\\\\main\\\\resources\\\\qlt_web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"D:\\\\LV\\\\qlt\\\\QLThuoc\\\\src\\\\main\\\\resources\\\\qlt_web\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport { ACTION_TYPES, API, LOCAL_STORAGE } from '../constants';\nimport { showAlertFail } from './alertAction.js';\nimport axios from 'axios';\nexport var login = function login(auth) {\n  return function (dispatch) {\n    return Promise(function (resolve, reject) {\n      try {\n        var res = axios.post(API.LOGIN, auth);\n        dispatch(loginSuccess(res.data));\n      } catch (err) {\n        resolve(err);\n        dispatch(setLoading());\n\n        if (err && err.response && err.response.data && err.response.data.message) {\n          dispatch(loginFail(err.response.data.message));\n        } else {\n          dispatch(loginFail(err.toString()));\n        }\n      }\n    });\n  };\n};\nexport var loginSuccess = function loginSuccess(data) {\n  sessionStorage.setItem(LOCAL_STORAGE.IS_LOGIN, true);\n  sessionStorage.setItem(LOCAL_STORAGE.ACCESS_KEY, data.jwtAuthenticationResponse.accessToken);\n  return {\n    type: ACTION_TYPES.AUTH.LOGIN_SUCCESS,\n    payload: data\n  };\n};\nexport var loginFail = function loginFail(err) {\n  return {\n    type: ACTION_TYPES.HAS_ERROR,\n    payload: err\n  };\n};\nexport var logout = function logout() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(dispatch) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return sessionStorage.removeItem(LOCAL_STORAGE.IS_LOGIN);\n\n              case 3:\n                _context.next = 5;\n                return sessionStorage.removeItem(LOCAL_STORAGE.ACCESS_KEY);\n\n              case 5:\n                return _context.abrupt(\"return\", dispatch(logoutSuccess()));\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                return _context.abrupt(\"return\", dispatch(showAlertFail(\"Thoát thất bại\")));\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 8]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var logoutSuccess = function logoutSuccess() {\n  return {\n    type: ACTION_TYPES.AUTH.LOGOUT\n  };\n};\nexport var setBranch = function setBranch(branch) {\n  return {\n    type: ACTION_TYPES.AUTH.SET_BRANCH,\n    payload: branch\n  };\n};\nexport var setLoading = function setLoading() {\n  return {\n    type: ACTION_TYPES.AUTH.SET_LOADING\n  };\n};","map":{"version":3,"sources":["D:\\LV\\qlt\\QLThuoc\\src\\main\\resources\\qlt_web\\src\\actions\\authenAction.js"],"names":["ACTION_TYPES","API","LOCAL_STORAGE","showAlertFail","axios","login","auth","dispatch","Promise","resolve","reject","res","post","LOGIN","loginSuccess","data","err","setLoading","response","message","loginFail","toString","sessionStorage","setItem","IS_LOGIN","ACCESS_KEY","jwtAuthenticationResponse","accessToken","type","AUTH","LOGIN_SUCCESS","payload","HAS_ERROR","logout","removeItem","logoutSuccess","LOGOUT","setBranch","branch","SET_BRANCH","SET_LOADING"],"mappings":"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","sourcesContent":["import {ACTION_TYPES, API, LOCAL_STORAGE} from '../constants';\nimport {showAlertFail} from './alertAction.js'\nimport axios from 'axios';\n\nexport const login = (auth) => (dispatch) => {\n  return Promise(function (resolve, reject) {\n    try {\n      const res = axios.post(API.LOGIN, auth);\n      dispatch(loginSuccess(res.data));\n    } catch (err) {\n      resolve(err);\n      dispatch(setLoading());\n      if (err && err.response && err.response.data && err.response.data.message) {\n        dispatch(loginFail(err.response.data.message));\n      } else {\n        dispatch(loginFail(err.toString()));\n      }\n    }\n  });\n}\nexport const loginSuccess = (data) => {\n  sessionStorage.setItem(LOCAL_STORAGE.IS_LOGIN, true);\n  sessionStorage.setItem(LOCAL_STORAGE.ACCESS_KEY, data.jwtAuthenticationResponse.accessToken);\n  return {\n    type: ACTION_TYPES.AUTH.LOGIN_SUCCESS,\n    payload: data\n  }\n}\n\nexport const loginFail = (err) => {\n  return {\n    type: ACTION_TYPES.HAS_ERROR,\n    payload: err\n  }\n}\n\nexport const logout = () => {\n  return async (dispatch) => {\n    try {\n      // const res = await axios.post(API.LOGOUT, null, headerConfig);\n      await sessionStorage.removeItem(LOCAL_STORAGE.IS_LOGIN);\n      await sessionStorage.removeItem(LOCAL_STORAGE.ACCESS_KEY);\n      return dispatch(logoutSuccess());\n    } catch (err) {\n      return dispatch(showAlertFail(\"Thoát thất bại\"));\n    }\n  }\n\n}\nexport const logoutSuccess = () => {\n  return {\n    type: ACTION_TYPES.AUTH.LOGOUT\n  }\n}\nexport const setBranch = (branch) => {\n  return {\n    type: ACTION_TYPES.AUTH.SET_BRANCH,\n    payload: branch\n  }\n}\nexport const setLoading = () => {\n  return {\n    type: ACTION_TYPES.AUTH.SET_LOADING\n  }\n}\n"]},"metadata":{},"sourceType":"module"}